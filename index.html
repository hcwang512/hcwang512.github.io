<!doctype html><html lang=en-us>
<head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge,chrome=1">
<title>whc512 Site</title>
<meta name=viewport content="width=device-width,minimum-scale=1">
<meta name=description content>
<meta name=generator content="Hugo 0.88.0">
<meta name=ROBOTS content="NOINDEX, NOFOLLOW">
<link rel=stylesheet href=/ananke/css/main.min.css>
<link href=/index.xml rel=alternate type=application/rss+xml title="whc512 Site">
<link href=/index.xml rel=feed type=application/rss+xml title="whc512 Site">
<meta property="og:title" content="whc512 Site">
<meta property="og:description" content>
<meta property="og:type" content="website">
<meta property="og:url" content="http://example.org/">
<meta itemprop=name content="whc512 Site">
<meta itemprop=description content><meta name=twitter:card content="summary">
<meta name=twitter:title content="whc512 Site">
<meta name=twitter:description content>
</head>
<body class="ma0 avenir bg-near-white">
<header>
<div class="pb3-m pb6-l bg-black">
<nav class="pv3 ph3 ph4-ns" role=navigation>
<div class="flex-l justify-between items-center center">
<a href=/ class="f3 fw2 hover-white no-underline white-90 dib">
whc512 Site
</a>
<div class="flex-l items-center">
</div>
</div>
</nav>
<div class="tc-l pv3 ph3 ph4-ns">
<h1 class="f2 f-subheadline-l fw2 light-silver mb0 lh-title">
whc512 Site
</h1>
</div>
</div>
</header>
<main class=pb7 role=main>
<article class="cf ph3 ph5-l pv3 pv4-l f4 tc-l center measure-wide lh-copy mid-gray">
</article>
<div class="pa3 pa4-ns w-100 w-70-ns center">
<h1 class=flex-none>
Recent Posts
</h1>
<section class="w-100 mw8">
<div class="relative w-100 mb4">
<article class="bb b--black-10">
<div class="db pv4 ph3 ph0-l no-underline dark-gray">
<div class="flex flex-column flex-row-ns">
<div class="blah w-100">
<h1 class="f3 fw1 athelas mt0 lh-title">
<a href=/posts/go_plugin/ class="color-inherit dim link">
Go plugin
</a>
</h1>
<div class="f6 f5-l lh-copy nested-copy-line-height nested-links">
golang 是静态编译型语言，在编译时就需要将所有引用的包加载到最终的可执行程序中。go plugin 提供了在运行时动态加载外部功能的能力。go plugin 带来的好处是可以动态加载，可插拔，可独立开发。其典型的使用场景是
业务逻辑由多个代码模块组成，这些模块由不同的团队维护。可以独立开发，发布.
业务的总体流程是相对固定的，针对不同的业务执行不同的插件。
使用的时候先将 plugin 编译为 so 动态库，在主函数中打开 so 文件，即可查找到 plugin 中的可导出变量和方法。
go plugin 的一个非常严重的缺点在于需要保证 plugin 和主工程的 go 版本，平台，编译参数都一致，否则会有 panic 报错。这个缺陷极大地限制了 go plugin 的使用。
因此 hashicorp 开发了 go-plugin 项目，plugin 是一个独立进程，与主进程通过本地网络 grpc 调用来双向交换数据。因为是进程间通信，而且传输数据是通过 pb 编码的。因此比 go plugin 有很多的好处。
不依赖 go 版本，平台，编译参数。 因为运行 plugin 在一个独立的进程中，因此 plugin panic 不会影响到主进程 支持双向通信 支持更多的语言 协议支持版本号。可以确保主进程总是适配 plugin 版本 支持多语言实现 plugin 可以做到平滑热更新 go-plugin 因为涉及到网络通信，数据编解码，因此在性能上带来一定的损耗。
</div>
<a href=/posts/go_plugin/ class="ba b--moon-gray bg-light-gray br2 color-inherit dib f7 hover-bg-moon-gray link mt2 ph2 pv1">read more</a>
</div>
</div>
</div>
</article>
</div>
<div class="relative w-100 mb4">
<article class="bb b--black-10">
<div class="db pv4 ph3 ph0-l no-underline dark-gray">
<div class="flex flex-column flex-row-ns">
<div class="blah w-100">
<h1 class="f3 fw1 athelas mt0 lh-title">
<a href=/posts/service_mesh/ class="color-inherit dim link">
Service mesh introduction
</a>
</h1>
<div class="f6 f5-l lh-copy nested-copy-line-height nested-links">
为什么需要 service_mesh 微服务的兴起和发展改变了工程师开发，构建，部署程序的方式。我们从单体应用的庞大代码库、扩展困难、迭代缓慢、单一技术栈的泥坑中被解救出来，旋即陷入了分布式系统的各种问题中。网络是不可靠的，网络的延迟是不稳定的，带宽是有限的，网络传输是有代价的，网络是不安全的，网络是异质的。诸多原因导致构建高可用，弹性的分布式系统是异常艰难的。经过多年的积累，我们总结出了一套通用技术指南。
超时 重试 熔断 限速节流 动态服务发现 动态路由 分布式追踪以及运行时指标 安全通信和访问控制 这些功能在实现的时候应该作为公用库，与业务逻辑解耦。Twitter 的 rpc 框架 finagle, Facebook 的 http 框架 proxygen 就是很好的例子。而这依然有一些问题。需要专门的团队来维护这些通用库；对不同的框架，运行时，语言都需要实现这些功能；对业务开发依然有较高的心智成本；治理成本比较高，升级维护困难。解决这些问题的思路就在于将公用库设计为位于网络栈和应用业务逻辑的独立层，即透明网络代理，作为独立的运行单元，与业务不再直接，紧密关联。即 service mesh. mesh 的结构 上图清晰地描述了 service mesh 在微服务中的位置和功能。我们会以 linkerd 为例分析 mesh 的结构。
总体来说，linkerd 主要由控制面和数据面构成。其中控制面为数据面上的行为提供控制数据；数据面则是由 rust 编写的轻量级代理，以 sidecar 的形式与应用容器一起部署，拦截处理所有的网络流量。 总结 service mesh 是微服务架构趋于成熟的标志。kubernetes 战胜 mesos, swarm 赢得了编排调度系统的竞争，kubernetes 的网络模型的竞争也基本结束。或许在不远的将来，service mesh 会成为 kubernetes 上的标配，并且有一个统一的实现。
</div>
<a href=/posts/service_mesh/ class="ba b--moon-gray bg-light-gray br2 color-inherit dib f7 hover-bg-moon-gray link mt2 ph2 pv1">read more</a>
</div>
</div>
</div>
</article>
</div>
<div class="relative w-100 mb4">
<article class="bb b--black-10">
<div class="db pv4 ph3 ph0-l no-underline dark-gray">
<div class="flex flex-column flex-row-ns">
<div class="blah w-100">
<h1 class="f3 fw1 athelas mt0 lh-title">
<a href=/posts/qinzhi/ class="color-inherit dim link">
秦制两千年
</a>
</h1>
<div class="f6 f5-l lh-copy nested-copy-line-height nested-links">
周末翻了 《秦制两千年》这本书，受到很深的震撼。
书中主要的观点是中国历史上从秦朝到清朝，虽然政治制度不断演化，本质上是秦制。而秦制的主要特点是追求散沙化和原子化的扁平社会结构，尽可能管控、汲取人力和物力，最终达到利出一孔，国富民穷的结果。
秦制并不追求人的全面而自由的发展，相反，它通过制度想要塑造的是愚民，贫民，弱民。这些制度有些是把农民完全禁锢在土地上，禁止流动；有些是通过繁重的赋税使得民众无法积累财产，甚至害怕拥有财产；有些是通过盐铁官营等措施，加重民众的经济负担；有些是通过连坐和告密制度营造恐怖，使得人人自危。等等不一而足。
与之形成对比的是，英国在13世纪就通过大宪章来限制国王的权力，保护民众的财产权和人身自由。
很多这种政策即使今天依然能找到影子，我们能顺利走出秦制吗？
</div>
<a href=/posts/qinzhi/ class="ba b--moon-gray bg-light-gray br2 color-inherit dib f7 hover-bg-moon-gray link mt2 ph2 pv1">read more</a>
</div>
</div>
</div>
</article>
</div>
</section>
</div>
</main>
<footer class="bg-black bottom-0 w-100 pa3" role=contentinfo>
<div class="flex justify-between">
<a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href=http://example.org/>
&copy; whc512 Site 2021
</a>
<div>
</div>
</div>
</footer>
</body>
</html>